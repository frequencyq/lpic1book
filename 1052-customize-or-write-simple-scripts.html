<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Jadi" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="LPIC1, 102, LPIC1-102-500, LPIC1, " />

<meta property="og:title" content="105.2 Customize or write simple scripts "/>
<meta property="og:url" content="./1052-customize-or-write-simple-scripts.html" />
<meta property="og:description" content="" />
<meta property="og:site_name" content="lpic1book" />
<meta property="og:article:author" content="Jadi" />
<meta property="og:article:published_time" content="2010-12-03T10:20:00+01:00" />
<meta name="twitter:title" content="105.2 Customize or write simple scripts ">
<meta name="twitter:description" content="">

        <title>105.2 Customize or write simple scripts  · lpic1book
</title>



        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4CZV14VZXW"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-4CZV14VZXW');
        </script>
        
    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class=site-name>lpic1book</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                </li>
                                <li ><a href="./">Home</a></li>
                                <li ><a href="./support">Support/Donate</a></li>
                                <li ><a href="./archives.html">Chapters</a></li>
                                <li ><a href="./tags.html">Tags</a></li>
                                <li><form action="https://www.google.com/search" method="get" target="_blank" class="navbar-search"> <input type="hidden" name="sitesearch" value="https://linux1st.com/"/><input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./1052-customize-or-write-simple-scripts.html">
                105.2 Customize or write simple scripts
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p><em>Weight: 4</em></p>
<h4>Description</h4>
<p>Candidates should be able to customize existing scripts, or write simple new Bash scripts.</p>
<h4>Key Knowledge Areas:</h4>
<ul>
<li>Use standard sh syntax (loops, tests)</li>
<li>Use command substitution</li>
<li>Test return values for success or failure or other information provided by a command</li>
<li>Execute chained commands.</li>
<li>Perform conditional mailing to the superuser</li>
<li>Correctly select the script interpreter through the shebang (#!) line</li>
<li>Manage the location, ownership, execution and suid-rights of scripts</li>
</ul>
<h4>Terms and Utilities</h4>
<ul>
<li>for</li>
<li>while</li>
<li>test</li>
<li>if</li>
<li>read</li>
<li>seq</li>
<li>exec</li>
<li>||</li>
<li>&amp;&amp;</li>
</ul>
<h2>combining commands</h2>
<p>If you want to run more than one command in line one, separate them by a <code>;</code>. So the <code>cd /tmp; ls</code> will run the <code>cd /tmp</code> and then <code>ls</code>. But there are more advanced usages too.</p>
<p>You can use <code>&amp;&amp;</code> and <code>||</code> as logical and / or chaining. In case of And, the execution will stop as soon as the first one fails to execute. In case of Or, the next command will only run if the first one fails. Just like in logic boards.</p>
<p>Confusing? Let me explain again. The system will always tried to <em>evaluate</em> the outcome of your chain. So if you have <code>A &amp;&amp; B</code> and A fails, the system does not need to test B (because the overall result will be False anyway). Same logic works for <code>A || B || C</code>. If A works fine, the overall evaluation will be True so no need for testing B or C. But if A fails, system will try B and if B fails, we have to try C. </p>
<p>We use chaining to create logical flows. For example:</p>
<div class="highlight"><pre><span></span><code>$ cp backup.gzip /backups/ <span class="o">&amp;&amp;</span> rm backup.gzip
</code></pre></div>

<p>works like this: copy the backup to this location and delete the file ONLY IF the previous copy was successful. </p>
<h3>Shell Scripts</h3>
<p>We can combine shell commands or programs and or some logic or loops to write large or small scripts. Shell scripts are useful when you want to <em>automate</em> some tasks in one larger command. Say a shell script called "do_backup.sh" may compress some files into a file, rename this file based on the current date and time and then save it on a remote site and at last delete the ones older than 1 month. </p>
<h3>Shebang</h3>
<p>There is a line at the beginning of scripts which starts with <code>#!</code> and continues with an executable who needs to run this script. It is called shebang and as mentioned, tells the shell which <em>interpreter</em> must be used to run this script.</p>
<blockquote>
<p>Note: In many programming languages (including bash &amp; python), a <code>#</code> at the beginning of a script indicates <em>comments</em>. Do not confuse it with the <em>Shebang</em> (#!)</p>
</blockquote>
<p>Commonly we run shells using <code>#!/bin/bash</code> or <code>#!/bin/sh</code></p>
<p>The rest of a shell script can use most of the commands you already now in addition with some more "programming" specific commands like loops, tests and such. Here is a primitive sample:</p>
<div class="highlight"><pre><span></span><code>#!/bin/bash

echo
echo &quot;We are learning! Wowww...&quot;
echo
</code></pre></div>

<blockquote>
<p>The <code>sh</code> is a more basic shell but it is compatible with most of the things we talk about. There are also options like <code>zsh</code> and <code>csh</code> but the LPIC is based on <code>bash</code>.</p>
</blockquote>
<h3>Variables</h3>
<p>Already seen in the previous section. You can define variables like this <code>VARNAME=VALUE</code>. Here is a sample:</p>
<div class="highlight"><pre><span></span><code>#!/bin/bash

NAME=Jadi

echo
echo &quot;$NAME is learning! Wowww...&quot;
echo
</code></pre></div>

<blockquote>
<p>Note: you can also do NAME="Jadi the geeking guy" if you need to have spaces in your values</p>
</blockquote>
<p>If you want to access the command line arguments in your shell script, use <code>$1</code>, <code>$2</code>, .... You can find the number of command line arguments via <code>$#</code> variable.</p>
<h3>Command substitution</h3>
<p>Sometimes you need to save the output of a command in a variable or use it in some way. To do so you can use <code>$(command)</code> or simply <code>\</code>command``. Look at these two samples:</p>
<div class="highlight"><pre><span></span><code>➜  FILES=$(ls -1) # the $FILES variable contains the list of all files

➜  ~ date +&#39;%Y%m%d-%H%m&#39;
20230408-1604
➜  ~ touch backup_`date +&#39;%Y%m%d-%H%m&#39;`.tar
➜  ~ ls
backup_20230408-1604.tar
</code></pre></div>

<h3>executing scripts</h3>
<p>In the Unix / Linux world, file should be executable to be executable! :D To do so use the <code>chmod</code> command with <code>+x</code>. After this step you can run your script by giving its path to shell. Please note that Linux by default does not looks into the current directory so if you are going to run a script at the current directory, you have to run <code>./script_name.sh</code>.</p>
<p>Another way to run a script is running <code>sh</code> or <code>bash</code> with the shell scripts name as its argument. That is <code>sh my_script.sh</code>.</p>
<p>In both above methods, the scripts runs inside a child bash process and <em>returns</em> back afterwards to the same shell. If want to override this and <em>replace</em> your current shell with the program you are going to run, use the <code>exec</code> build-in command. The <code>-c</code> switch will run the command in a clean environment.</p>
<h3>Conditions</h3>
<p>Up to now, we were just running commands one by one. That is not very <em>programmatic</em>. If we are going to have some <em>logic</em> in our programs, we need <em>conditions</em> and <em>loops</em>. First we will cover conditions, using the <code>if</code> command. Its usage is like this:</p>
<div class="highlight"><pre><span></span><code>if [condition]
then
   do something
   do another thing
else
   do new things
   even funnier things
fi
</code></pre></div>

<blockquote>
<p>Note: else part is optional, <code>if</code>, <code>then</code>, <code>fi</code> is enough.</p>
</blockquote>
<p>Conditions can be TRUE or FALSE. A very simple conditions is <code>if [ "Linux" = "Linux" ]</code>. Silly? I know but wait; we are learning the syntax only. Please give special attention to the <em>spaces</em> and <em>=</em> for checking if two strings are equal.</p>
<div class="highlight"><pre><span></span><code>#!/bin/bash

kernel=$(uname -s)
if [ $kernel = &quot;Linux&quot; ]
then
    echo YES. You are using a Linux
else
    echo &quot;Not a linux :(&quot;
fi
</code></pre></div>

<p>The command to check conditions is the <code>test</code> command but since it is used a lot, we have a shortcut for it. Instead of <code>test condition</code> you can write <code>[ condition ]</code>. </p>
<table>
<thead>
<tr>
<th align="left">conditions</th>
<th align="left">what is means</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">"a" = "b"</td>
<td align="left">if two strings are equal (here it will return False)</td>
</tr>
<tr>
<td align="left">"a" != "b"</td>
<td align="left">string a <em>is not equal</em> to string b</td>
</tr>
<tr>
<td align="left">4 -lt 40</td>
<td align="left">if 4 is <em>lower   than</em> 40 (True)</td>
</tr>
<tr>
<td align="left">5 -gt 15</td>
<td align="left">if 5 is <em>greater than</em> 15 (False)</td>
</tr>
<tr>
<td align="left">5 -ge 5</td>
<td align="left">if 5 is <em>greater or equal</em> 5</td>
</tr>
<tr>
<td align="left">5 -le 3</td>
<td align="left">if 5 is <em>lower or equal</em> to 3</td>
</tr>
<tr>
<td align="left">9 -ne 2</td>
<td align="left">9 is <em>not equal</em> with 2 (True)</td>
</tr>
<tr>
<td align="left">-f FILENAME</td>
<td align="left">if file FILENAME exists</td>
</tr>
<tr>
<td align="left">-s FILENAME</td>
<td align="left">if file exists and its size is more than 0</td>
</tr>
<tr>
<td align="left">-x FILENAME</td>
<td align="left">file exists and is executable</td>
</tr>
</tbody>
</table>
<h3>read</h3>
<p>Using <code>read</code> we can read the user input. Look at this:</p>
<div class="highlight"><pre><span></span><code>#!/bin/sh

echo &quot;what is your name?&quot;
read NAME

echo &quot;Hello $NAME&quot;

if [ $NAME = &quot;Jadi&quot; ]
then
    echo &quot;Oh I know you!&quot;
else
    echo &quot;I wish I knew you&quot;
fi
echo &quot;Bye&quot;
</code></pre></div>

<p>You can timeout the waiting using the <code>-t</code> and show a prompt using <code>-p</code>. </p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="nv">read</span> <span class="o">-</span><span class="nv">t</span> <span class="mi">10</span> <span class="o">-</span><span class="nv">p</span> <span class="s2">&quot;</span><span class="s">Server address?</span><span class="s2">&quot;</span> <span class="nv">SERVER</span>
<span class="k">then</span>
    <span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">Connecting to the $SERVER ...</span><span class="s2">&quot;</span>
<span class="k">else</span>
    <span class="nv">echo</span>
    <span class="nv">echo</span> <span class="s2">&quot;</span><span class="s">Too late!</span><span class="s2">&quot;</span>
<span class="nv">fi</span>
</code></pre></div>

<h3>loops</h3>
<p>In programming loops are used to repeat part of the programs. We have 2 different loops in Bash; <code>for</code> and <code>while</code>. The for loops lets us run part of a program for a specific number of iterations. The <code>while</code> loop is used when we want to repeat part of a program <em>while</em> a specific condition is true. </p>
<h4>for</h4>
<p>The syntax is like this:</p>
<div class="highlight"><pre><span></span><code>for VAR in SOME_LIST;
do
  some stuff with $VAR
  some other stuff
done
</code></pre></div>

<blockquote>
<p>Note the <code>in</code>, <code>;</code>, <code>do</code> and <code>done</code>.</p>
</blockquote>
<p>On each iteration, the VAR will be equal to one of the SOME_LIST elements. SOME_LIST can be numbers, name of files, words, ...</p>
<div class="highlight"><pre><span></span><code>for NUM in 1 2 3 4 5 6;
do
    echo $NUM
done
</code></pre></div>

<p>But what if you needed to run from 1 to 42? We have the <code>seq</code> command for that. The <code>seq 1 42</code> or its shorthand <code>{1..42}</code> will let us run a loop 42 times.</p>
<p>We can also use non-numeric variables here. This is a common use case:</p>
<div class="highlight"><pre><span></span><code>for FILE in $(ls);
do
    echo $FILE
    wc -l $FILE
done
</code></pre></div>

<h4>while</h4>
<p>This is the syntax:</p>
<div class="highlight"><pre><span></span><code>while [condition]
do
    do something
    do anohter thing
done
</code></pre></div>

<blockquote>
<p>If your condition stays true all the time, the <code>while</code> loop will run <em>forever</em>. This is called an <em>infinite loop</em> and should be stopped by a <code>Ctrl+C</code>.</p>
</blockquote>
<p>This is sample:</p>
<div class="highlight"><pre><span></span><code>VAR=52

while [ $VAR -gt 42 ]
do
    echo VAR is $VAR and it is still greater than 42
    let VAR=VAR-1
done
</code></pre></div>

<blockquote>
<p>Note the <code>let</code> usage! If you just just say <code>VAR=1</code> and then <code>VAR=$VAR+1</code>, then VAR will be equal to <code>1+1</code> as an string!.</p>
</blockquote>
<h3>mailing the root user</h3>
<p>For sending mail, you need to install <code>mailutils</code>. Then the <code>mail</code> command will send emails. You can send the mail to the root user by issuing this command:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ mail root
Cc:
Subject: Hi there root
hello there. This is my mail
</code></pre></div>

<p>And root will get this email. She can read it using <code>mail</code> command.</p>
<p>If you need to send emails in a script, just do:</p>
<div class="highlight"><pre><span></span><code>$ echo &quot;Body!&quot; | mail -s &quot;Subject&quot; root
</code></pre></div>

<h2>returned values</h2>
<p>In the Unix world, the programs return values when they are finished. If you have programmed C, this is the <code>return 0</code> at the end. Commonly a 0 means successful execution. This return value can be read / examined using <code>$?</code> variable. </p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@ubuntuserver</span><span class="err">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">skel</span><span class="err">$</span><span class="w"> </span><span class="n">touch</span><span class="w"> </span><span class="o">/</span><span class="n">chert</span><span class="w"></span>
<span class="nl">touch</span><span class="p">:</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">touch</span><span class="w"> </span><span class="s1">&#39;/chert&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">Permission</span><span class="w"> </span><span class="n">denied</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="err">$</span><span class="vm">?</span><span class="w"></span>
<span class="mi">1</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">touch</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="mi">11</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="err">$</span><span class="vm">?</span><span class="w"></span>
<span class="mi">0</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="o">/</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="err">$</span><span class="vm">?</span><span class="w"></span>
<span class="mi">0</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="o">/</span><span class="n">nonexist</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="err">$</span><span class="vm">?</span><span class="w"></span>
<span class="mi">1</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">dummycommand</span><span class="w"></span>
<span class="nl">dummycommand</span><span class="p">:</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">found</span><span class="w"></span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="err">$</span><span class="vm">?</span><span class="w"></span>
<span class="mi">127</span><span class="w"></span>
</code></pre></div>

<h2>Bonus</h2>
<p>Just found my old <code>general_backup.sh</code> script and <a href="https://github.com/jadijadi/general_scripts/blob/main/backup_general_jadi.sh">uploaded it to github for you</a>. Nothing fancy but shows you how a general bash script can help you on your daily tasks.</p>


             
 
            
            
            







            <hr/>

            <!-- show next and previous links -->
            <table style="background: white; border: 0; font-size: 0.8em;"><tr>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <td style="background: white; border: 0;">
                            <a href="./1051-customize-and-use-the-shell-environment.html">← 105.1 Customize and use the shell environment</a>
                </td>
                <td style="background: white; border: 0;"><center ><a href="/archives.html">Chapter List</a></center></td>
                <td style="background: white; border: 0; text-align: right;">
                            <a href="./1053-removed.html">105.3 Removed! →</a>
                </td>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </tr></table>
            
            <hr />


	<div class=comment>

<div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://linux1st.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


	</div>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#lpic1-ref">LPIC1</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="./tags.html#102-ref">102
                    <span class="superscript">20</span>
</a></li>
                <li><a href="./tags.html#lpic1-ref">LPIC1
                    <span class="superscript">42</span>
</a></li>
                <li><a href="./tags.html#lpic1-102-500-ref">LPIC1-102-500
                    <span class="superscript">20</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>